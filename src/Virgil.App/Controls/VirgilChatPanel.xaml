<UserControl x:Class="Virgil.App.Controls.VirgilChatPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             MinHeight="120" Background="Transparent">
    <Grid>
        <ScrollViewer x:Name="Scroller" VerticalScrollBarVisibility="Auto" Background="Transparent">
            <ItemsControl x:Name="List" ItemsSource="{Binding Messages}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Margin="8" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border x:Name="Bubble"
                                CornerRadius="10"
                                Padding="12"
                                Margin="0,4"
                                Background="#142235"
                                BorderBrush="#2BD2FF"
                                BorderThickness="1">
                            <Grid>
                                <TextBlock Text="{Binding Text}"
                                           TextWrapping="Wrap" Foreground="White"/>
                                <!-- halo holo -->
                                <Rectangle IsHitTestVisible="False" Opacity="0.25">
                                    <Rectangle.Fill>
                                        <RadialGradientBrush GradientOrigin="0.2,0.0" RadiusX="1.2" RadiusY="1.0">
                                            <GradientStop Color="#0027D7FF" Offset="0"/>
                                            <GradientStop Color="#4027D7FF" Offset="1"/>
                                        </RadialGradientBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Grid>
                        </Border>
                        <DataTemplate.Triggers>
                            <!-- entrée douce -->
                            <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="Bubble"
                                                         Storyboard.TargetProperty="Opacity"
                                                         From="0" To="1" Duration="0:0:0.18"/>
                                        <ThicknessAnimation Storyboard.TargetName="Bubble"
                                                            Storyboard.TargetProperty="Margin"
                                                            From="0,8,0,0" To="0,4,0,0" Duration="0:0:0.18"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- couche particules pour l’effet Thanos -->
        <Canvas x:Name="DustLayer" IsHitTestVisible="False"/>
    </Grid>
</UserControl>