<UserControl x:Class="Virgil.App.Controls.VirgilAvatar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Width="72" Height="72">
    <Grid>
        <!-- halo -->
        <Ellipse x:Name="Halo" Width="72" Height="72">
            <Ellipse.Effect>
                <DropShadowEffect Color="#4FFFFFFF" BlurRadius="20" ShadowDepth="0" Opacity="0.8"/>
            </Ellipse.Effect>
            <Ellipse.Fill>
                <RadialGradientBrush GradientOrigin="0.5,0.5" RadiusX="0.9" RadiusY="0.9">
                    <GradientStop Offset="0.0" Color="#66FFFFFF" />
                    <GradientStop Offset="1.0" Color="#0040A0FF" />
                </RadialGradientBrush>
            </Ellipse.Fill>
        </Ellipse>

        <!-- noyau : scale liÃ© au ProgressScale du ViewModel -->
        <Ellipse x:Name="Core" Width="42" Height="42" Fill="{Binding CoreBrush}">
            <Ellipse.RenderTransform>
                <ScaleTransform ScaleX="{Binding ProgressScale}" ScaleY="{Binding ProgressScale}"/>
            </Ellipse.RenderTransform>
            <Ellipse.RenderTransformOrigin>0.5,0.5</Ellipse.RenderTransformOrigin>
        </Ellipse>

        <!-- bulle -->
        <Border Background="#CC111111" CornerRadius="8" Padding="6,3"
                HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,-4,-4">
            <TextBlock Text="{Binding CurrentLine}" Foreground="#EDEDED" FontSize="11"/>
        </Border>

        <!-- respiration subtile du halo -->
        <Grid.Triggers>
            <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard>
                    <Storyboard RepeatBehavior="Forever" AutoReverse="True">
                        <DoubleAnimation Storyboard.TargetName="Halo"
                                         Storyboard.TargetProperty="Opacity"
                                         From="0.85" To="0.65" Duration="0:0:2.2"/>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Grid.Triggers>
    </Grid>
</UserControl>
