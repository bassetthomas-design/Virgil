<UserControl x:Class="Virgil.App.Controls.VirgilAvatar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="clr-namespace:Virgil.App.Controls"
             mc:Ignorable="d" d:DesignHeight="260" d:DesignWidth="260">
  <Grid>
    <!-- halo / fond -->
    <Ellipse Width="220" Height="220"
             Fill="{Binding BodyBrush}"
             Stroke="#FFF" StrokeThickness="8"
             Effect="{StaticResource DropShadowEffect}"
             HorizontalAlignment="Center" VerticalAlignment="Center"/>

    <!-- oreilles / accessoires selon style -->
    <Grid>
      <!-- cat -->
      <Grid Visibility="{Binding IsCat, Converter={StaticResource BoolToVis}}">
        <Path Fill="#FFF" Data="M 90,40 L 120,10 L 140,40 Z"
              HorizontalAlignment="Left" VerticalAlignment="Top" Margin="18,22,0,0"/>
        <Path Fill="#FFF" Data="M 100,40 L 70,10 L 50,40 Z"
              HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,22,18,0"/>
        <!-- moustaches -->
        <Rectangle Fill="#FFF" Width="30" Height="6" RadiusX="3" RadiusY="3"
                   HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,0,0,0"/>
        <Rectangle Fill="#FFF" Width="30" Height="6" RadiusX="3" RadiusY="3"
                   HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,30,0,0"/>
        <Rectangle Fill="#FFF" Width="30" Height="6" RadiusX="3" RadiusY="3"
                   HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,-30,0,0"/>
        <Rectangle Fill="#FFF" Width="30" Height="6" RadiusX="3" RadiusY="3"
                   HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,0"/>
        <Rectangle Fill="#FFF" Width="30" Height="6" RadiusX="3" RadiusY="3"
                   HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,30,10,0"/>
        <Rectangle Fill="#FFF" Width="30" Height="6" RadiusX="3" RadiusY="3"
                   HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,-30,10,0"/>
      </Grid>

      <!-- devil -->
      <Grid Visibility="{Binding IsDevil, Converter={StaticResource BoolToVis}}">
        <Path Fill="#FFF" Data="M 70,30 L 100,10 L 95,40 Z"
              HorizontalAlignment="Left" VerticalAlignment="Top" Margin="30,10,0,0"/>
        <Path Fill="#FFF" Data="M 130,30 L 100,10 L 105,40 Z"
              HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,10,30,0"/>
      </Grid>
    </Grid>

    <!-- yeux -->
    <Grid Width="140" Height="70" HorizontalAlignment="Center" VerticalAlignment="Center">
      <!-- œil gauche -->
      <Border Background="#FFF"
              CornerRadius="20"
              Width="{Binding EyeWidth}" Height="{Binding EyeHeight}"
              Margin="{Binding EyeSeparation, Converter={StaticResource EyeSeparationToMarginConverter}, ConverterParameter=Left}">
        <!-- paupière (blink) -->
        <Border.Background>
          <SolidColorBrush Color="#FFFFFF"/>
        </Border.Background>
        <Border.OpacityMask>
          <RectangleGeometry Rect="0,0,1,1"/>
        </Border.OpacityMask>
        <Border RenderTransformOrigin="0.5,0.5">
          <Border.RenderTransform>
            <ScaleTransform ScaleY="{Binding Blink}" />
          </Border.RenderTransform>
        </Border>
      </Border>

      <!-- œil droit -->
      <Border Background="#FFF"
              CornerRadius="20"
              Width="{Binding EyeWidth}" Height="{Binding EyeHeight}"
              Margin="{Binding EyeSeparation, Converter={StaticResource EyeSeparationToMarginConverter}, ConverterParameter=Right}">
        <Border.RenderTransform>
          <ScaleTransform ScaleY="{Binding Blink}" />
        </Border.RenderTransform>
      </Border>
    </Grid>

    <!-- pupilles / humeur (regards inclinés) -->
    <Grid Width="160" Height="90" HorizontalAlignment="Center" VerticalAlignment="Center">
      <!-- neutral / vigilant / proud -->
      <Grid Visibility="{Binding IsFlatEyes, Converter={StaticResource BoolToVis}}">
        <Ellipse Width="22" Height="22" Fill="{Binding EyeBrush}"
                 Margin="{Binding EyeSeparation, Converter={StaticResource EyeSeparationToMarginConverter}, ConverterParameter=Left}"
                 VerticalAlignment="Center" />
        <Ellipse Width="22" Height="22" Fill="{Binding EyeBrush}"
                 Margin="{Binding EyeSeparation, Converter={StaticResource EyeSeparationToMarginConverter}, ConverterParameter=Right}"
                 VerticalAlignment="Center" />
      </Grid>

      <!-- angry/alert (yeux inclinés) -->
      <Grid Visibility="{Binding IsAngry, Converter={StaticResource BoolToVis}}">
        <Path Stroke="{Binding EyeBrush}" StrokeThickness="8" Data="M 20,55 L 60,35"
              StrokeEndLineCap="Round" StrokeStartLineCap="Round"/>
        <Path Stroke="{Binding EyeBrush}" StrokeThickness="8" Data="M 100,35 L 140,55"
              StrokeEndLineCap="Round" StrokeStartLineCap="Round"/>
      </Grid>

      <!-- love -->
      <Grid Visibility="{Binding IsLove, Converter={StaticResource BoolToVis}}">
        <Path Fill="{Binding EyeBrush}"
              Data="M 38,60 C 10,35 40,20 52,35 C 64,20 94,35 66,60 Z"
              HorizontalAlignment="Left" Margin="20,0,0,0"/>
        <Path Fill="{Binding EyeBrush}"
              Data="M 94,60 C 66,35 96,20 108,35 C 120,20 150,35 122,60 Z"
              HorizontalAlignment="Right" Margin="0,0,20,0"/>
      </Grid>

      <!-- sad -->
      <Grid Visibility="{Binding IsSad, Converter={StaticResource BoolToVis}}">
        <Path Stroke="{Binding EyeBrush}" StrokeThickness="8" Data="M 20,40 C 40,60 60,60 80,40"
              StrokeEndLineCap="Round" StrokeStartLineCap="Round"/>
        <Path Stroke="{Binding EyeBrush}" StrokeThickness="8" Data="M 80,40 C 100,60 120,60 140,40"
              StrokeEndLineCap="Round" StrokeStartLineCap="Round"/>
      </Grid>
    </Grid>
  </Grid>
</UserControl>
