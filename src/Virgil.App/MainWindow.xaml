<Window x:Class="Virgil.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Virgil.App"
        xmlns:controls="clr-namespace:Virgil.App.Controls"
        Title="Virgil" Height="720" Width="1200"
        WindowStartupLocation="CenterScreen">
  <Grid Background="#111">
    <Grid.RowDefinitions>
      <RowDefinition Height="48"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="24"/>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="340"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <!-- TOP BAR -->
    <DockPanel Grid.Row="0" Grid.ColumnSpan="2" Background="#222" LastChildFill="True" Padding="10,0">
      <ToggleButton x:Name="SurveillanceToggle"
                    Width="190" Height="32" Margin="0,8,10,8"
                    Content="Démarrer la surveillance"
                    IsChecked="{Binding IsMonitoring, Mode=TwoWay}"
                    Checked="SurveillanceToggle_Checked"
                    Unchecked="SurveillanceToggle_Unchecked"/>
      <TextBlock x:Name="ClockText" FontSize="16" Foreground="White"
                 HorizontalAlignment="Right" VerticalAlignment="Center"/>
    </DockPanel>

    <!-- LEFT PANEL: Avatar + Stats -->
    <StackPanel Grid.Row="1" Grid.Column="0" Spacing="16" Margin="16">
      <controls:VirgilAvatar x:Name="Avatar" Width="220" Height="220"/>

      <GroupBox Header="Ressources" Foreground="White" BorderBrush="#444">
        <StackPanel Margin="10" Spacing="10">
          <StackPanel>
            <TextBlock Foreground="White" Text="CPU"/>
            <ProgressBar x:Name="CpuBar" Height="16" Maximum="100"/>
            <TextBlock x:Name="CpuTemp" Foreground="Gray" FontSize="12"/>
          </StackPanel>
          <StackPanel>
            <TextBlock Foreground="White" Text="GPU"/>
            <ProgressBar x:Name="GpuBar" Height="16" Maximum="100"/>
            <TextBlock x:Name="GpuTemp" Foreground="Gray" FontSize="12"/>
          </StackPanel>
          <StackPanel>
            <TextBlock Foreground="White" Text="Mémoire"/>
            <ProgressBar x:Name="MemBar" Height="16" Maximum="100"/>
          </StackPanel>
          <StackPanel>
            <TextBlock Foreground="White" Text="Disque"/>
            <ProgressBar x:Name="DiskBar" Height="16" Maximum="100"/>
            <TextBlock x:Name="DiskTemp" Foreground="Gray" FontSize="12"/>
          </StackPanel>
        </StackPanel>
      </GroupBox>

      <GroupBox Header="Actions" Foreground="White" BorderBrush="#444">
        <UniformGrid Columns="2" Rows="2" Margin="10"
                      HorizontalAlignment="Stretch" VerticalAlignment="Center"
                      >
          <Button Click="Action_MaintenanceComplete" Margin="6">Maintenance complète</Button>
          <Button Click="Action_CleanTemp" Margin="6">Nettoyer TEMP</Button>
          <Button Click="Action_CleanBrowsers" Margin="6">Nettoyer navigateurs</Button>
          <Button Click="Action_UpdateAll" Margin="6">Tout mettre à jour</Button>
        </UniformGrid>
      </GroupBox>
    </StackPanel>

    <!-- RIGHT PANEL: Chat -->
    <Grid Grid.Row="1" Grid.Column="1" Margin="16">
      <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>

      <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
        <ItemsControl x:Name="ChatList">
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <Border CornerRadius="8" Padding="8" Margin="0,6" Background="{Binding BubbleBrush}">
                <TextBlock Text="{Binding Text}" Foreground="White" TextWrapping="Wrap"/>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </ScrollViewer>

      <DockPanel Grid.Row="1" Margin="0,8,0,0">
        <TextBox x:Name="UserInput" Height="32" Margin="0,0,8,0"/>
        <Button Width="120" Content="Envoyer" Click="SendButton_Click"/>
      </DockPanel>
    </Grid>

    <!-- STATUS BAR -->
    <StatusBar Grid.Row="2" Grid.ColumnSpan="2">
      <StatusBarItem>
        <TextBlock x:Name="StatusText"/>
      </StatusBarItem>
    </StatusBar>
  </Grid>
</Window>
