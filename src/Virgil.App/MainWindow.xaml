<Window x:Class="Virgil.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:Virgil.App.Controls"
        Title="Virgil" Height="720" Width="1200"
        WindowStartupLocation="CenterScreen">
  <Grid Background="#0E1116">
    <Grid.RowDefinitions>
      <RowDefinition Height="56"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="28"/>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="360"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <!-- TOP BAR -->
    <Border Grid.Row="0" Grid.ColumnSpan="2" Background="#171B21" Padding="12,0">
      <DockPanel LastChildFill="True">
        <ToggleButton x:Name="SurveillanceToggle"
                      Width="210" Height="36" Margin="0,10,10,10"
                      Content="D√©marrer la surveillance"
                      Checked="SurveillanceToggle_Checked"
                      Unchecked="SurveillanceToggle_Unchecked"/>
        <Button Content="Config" Width="100" Height="36" Margin="0,10,10,10"
                Click="OpenConfig_Click"/>
        <TextBlock x:Name="ClockText" FontSize="16" Foreground="White"
                   HorizontalAlignment="Right" VerticalAlignment="Center"/>
      </DockPanel>
    </Border>

    <!-- LEFT: avatar + stats + actions -->
    <ScrollViewer Grid.Row="1" Grid.Column="0" Margin="16,16,8,16" VerticalScrollBarVisibility="Auto">
      <StackPanel>
        <controls:VirgilAvatar x:Name="Avatar" Width="220" Height="220" HorizontalAlignment="Center"/>

        <GroupBox Header="Ressources" Foreground="White" BorderBrush="#2A2F36" Margin="0,16,0,0">
          <StackPanel Margin="10">
            <!-- CPU -->
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
              <TextBlock Foreground="White" Text="CPU"/>
              <TextBlock x:Name="CpuBadge" Text="‚ö†" Foreground="#F1C40F" Margin="6,0,0,0" Visibility="Collapsed"/>
              <TextBlock x:Name="CpuBadgeHot" Text="üî•" Foreground="#E74C3C" Margin="6,0,0,0" Visibility="Collapsed"/>
            </StackPanel>
            <ProgressBar x:Name="CpuBar" Height="16" Maximum="100" ToolTipService.ShowDuration="20000"/>
            <TextBlock x:Name="CpuTemp" Foreground="#9aa4b1" FontSize="12"/>

            <!-- GPU -->
            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
              <TextBlock Foreground="White" Text="GPU"/>
              <TextBlock x:Name="GpuBadge" Text="‚ö†" Foreground="#F1C40F" Margin="6,0,0,0" Visibility="Collapsed"/>
              <TextBlock x:Name="GpuBadgeHot" Text="üî•" Foreground="#E74C3C" Margin="6,0,0,0" Visibility="Collapsed"/>
            </StackPanel>
            <ProgressBar x:Name="GpuBar" Height="16" Maximum="100" ToolTipService.ShowDuration="20000"/>
            <TextBlock x:Name="GpuTemp" Foreground="#9aa4b1" FontSize="12"/>

            <!-- MEM -->
            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
              <TextBlock Foreground="White" Text="M√©moire"/>
              <TextBlock x:Name="MemBadge" Text="‚ö†" Foreground="#F1C40F" Margin="6,0,0,0" Visibility="Collapsed"/>
              <TextBlock x:Name="MemBadgeHot" Text="üî•" Foreground="#E74C3C" Margin="6,0,0,0" Visibility="Collapsed"/>
            </StackPanel>
            <ProgressBar x:Name="MemBar" Height="16" Maximum="100" ToolTipService.ShowDuration="20000"/>

            <!-- DISK -->
            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
              <TextBlock Foreground="White" Text="Disque"/>
              <TextBlock x:Name="DiskBadge" Text="‚ö†" Foreground="#F1C40F" Margin="6,0,0,0" Visibility="Collapsed"/>
              <TextBlock x:Name="DiskBadgeHot" Text="üî•" Foreground="#E74C3C" Margin="6,0,0,0" Visibility="Collapsed"/>
            </StackPanel>
            <ProgressBar x:Name="DiskBar" Height="16" Maximum="100" ToolTipService.ShowDuration="20000"/>
            <TextBlock x:Name="DiskTemp" Foreground="#9aa4b1" FontSize="12"/>
          </StackPanel>
        </GroupBox>

        <GroupBox Header="Actions" Foreground="White" BorderBrush="#2A2F36" Margin="0,16,0,0">
          <UniformGrid Columns="2" Rows="2" Margin="10">
            <Button Click="Action_MaintenanceComplete" Margin="6">Maintenance compl√®te</Button>
            <Button Click="Action_CleanTemp" Margin="6">Nettoyer TEMP</Button>
            <Button Click="Action_CleanBrowsers" Margin="6">Nettoyer navigateurs</Button>
            <Button Click="Action_UpdateAll" Margin="6">Tout mettre √† jour</Button>
          </UniformGrid>
        </GroupBox>
      </StackPanel>
    </ScrollViewer>

    <!-- RIGHT: chat styl√© -->
    <Grid Grid.Row="1" Grid.Column="1" Margin="8,16,16,16">
      <ScrollViewer VerticalScrollBarVisibility="Auto">
        <ItemsControl x:Name="ChatList">
          <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
              <StackPanel/>
            </ItemsPanelTemplate>
          </ItemsControl.ItemsPanel>
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <Border Style="{StaticResource VirgilBubble}"
                      Background="{Binding BubbleBrush}"
                      Opacity="{Binding Opacity}">
                <Border.RenderTransform>
                  <ScaleTransform ScaleX="{Binding Scale}" ScaleY="{Binding Scale}"/>
                </Border.RenderTransform>
                <TextBlock Text="{Binding Text}" Foreground="White" TextWrapping="Wrap"/>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </ScrollViewer>
    </Grid>

    <!-- STATUS -->
    <StatusBar Grid.Row="2" Grid.ColumnSpan="2" Background="#171B21">
      <StatusBarItem>
        <TextBlock x:Name="StatusText" Foreground="White"/>
      </StatusBarItem>
      <StatusBarItem HorizontalAlignment="Right">
        <ProgressBar x:Name="ActionProgress" Width="140" Height="14" IsIndeterminate="True" Visibility="Collapsed"/>
      </StatusBarItem>
    </StatusBar>
  </Grid>
</Window>
